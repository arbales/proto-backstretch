//
// Proto Backstretch
// Version 1.0
//
// A port of jQuery Backstretch
// http://srobbin.com/jquery-plugins/jquery-backstretch/
//
// Add a dynamically-resized background image to the page
//         
// Copyright (c) 2010 Scott Robbin (srobbin.com), Austin Bales (austinbales.com)
// Dual licensed under the MIT and GPL licenses.
//

var Backstretch;var __bind=function(a,b){return function(){return a.apply(b,arguments)}};Backstretch=(function(){function a(c,b){this.src=c;this.settings={centeredX:true,centeredY:true,speed:1};if(b&&typeof b==="object"){Object.extend(this.settings,b)}if(this.src){this.container=new Element("div",{id:"backstretch"});this.container.setStyle({left:0,top:0,position:"fixed",overflow:"hidden",zIndex:-998});this.create_image();document.body.insert({top:this.container});this.img.src=this.src}Event.observe(window,"resize",__bind(function(){return this.adjust()},this));this}a.prototype.create_image=function(){this.img=new Element("img");this.img.setStyle({position:"relative",display:"none"});this.img.observe("load",__bind(function(b){this.container.insert(this.img);this.ratio=this.img.width/this.img.height;if(Prototype.Browser.IE){return this.img.appear({duration:this.settings.speed,after:__bind(function(){return this.adjust()},this)})}else{return this.img.appear({duration:this.settings.speed,before:__bind(function(){return this.adjust()},this)})}},this));return this};a.prototype.change_source=function(b){if(b!==this.img.src){this.img.fade({after:__bind(function(){this.img.remove();this.create_image();return this.img.src=b},this)})}return this};a.prototype.adjust=function(){var e,c,f,g,d,b;b=document.viewport.getWidth();d=document.viewport.getHeight();e={left:0,top:0};g=b;c=g/this.ratio;if(c>=d){f=(c-d)/2;if(this.settings.centeredY){Object.extend(e,{top:"-"+f+"px"})}}else{c=d+10;g=c*this.ratio;f=(g-b)/2;if(this.settings.centeredX){Object.extend(e,{left:"-"+f+"px"})}}this.img.setStyle("width: "+g+"px; height:"+c+"px;").setStyle(e);return this};return a})();